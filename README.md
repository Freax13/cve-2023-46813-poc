# linux eop poc

1. Apply the patches in the `host-patches` folder to the Linux host and QEMU.
2. Start an SEV-SNP VM.
3. Run the code in this repo and wait for the message "waiting for hypervisor to change memory to MMIO".
4. Spam the `attack` command in QEMU a couple of times.
5. Once the exploit detects that the memory type of some of its memory has been changed to MMIO it will use the vulnerability to swap out its own credentials with those of the init tasks.

Successfull exploitation will looks like this:
![](./screenshot.png)

The exploit doesn't rely on any absolute kernel offsets, but relies on the relative offsets of fields in the `struct task_struct` type. You might have to adjust those.